

<!DOCTYPE html>
<html class="no-js" lang="en">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> Scylla Metrics | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
    <link
      rel="icon"
      href="../_static/img/favicon.ico"
      type="image/x-icon"
    />
    <link
      rel="icon"
      href="../_static/img/favicon-32x32.png"
      sizes="32x32"
    />
    <link
      rel="icon"
      href="../_static/img/favicon-228x228.png"
      sizes="192x192"
    />
    <link
      rel="apple-touch-icon"
      href="../_static/img/favicon-228x228.png"
    />
    <meta
      name="msapplication-TileImage"
      href="../_static/img/favicon-228x228.png"
    />
    <link rel="canonical" href="https://docs.scylladb.com/" />
    <link rel="author" href="mailto:info@scylladb.com" />
  <!-- connect to domain of font files -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- optionally increase loading priority -->
  <link
    rel="preload"
    as="style"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
  />

  <!-- async CSS -->
  <link
    rel="stylesheet"
    media="print"
    onload="this.onload=null;this.removeAttribute('media');"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
  />

  <!-- no-JS fallback -->
  <noscript>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap"
    />
  </noscript>
  <link
    rel="stylesheet"
    href="../_static/css/main.css"
    type="text/css"
  />
  <link
    rel="stylesheet"
    href="../_static/pygments.css"
    type="text/css"
  /> <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />

  <script
    type="text/javascript"
    id="documentation_options"
    data-url_root="../"
    src="../_static/documentation_options.js"
  ></script>
  <script
    type="text/javascript"
    src="../_static/js/runtime.bundle.js"
  ></script>
  <script
    type="text/javascript"
    src="../_static/js/main.bundle.js"
  ></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/doctools.js"></script> <script src="../_static/language_data.js"></script> <script src="../_static/clipboard.min.js"></script> <script src="../_static/copybutton.js"></script>

    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-T8P2JP");
    </script>
    <!-- End Google Tag Manager -->
    <!-- Marketo -->
    <script type="text/javascript">
      (function () {
        var didInit = false;
        function initMunchkin() {
          if (didInit === false) {
            didInit = true;
            Munchkin.init("791-QBF-350");
          }
        }
        var s = document.createElement("script");
        s.type = "text/javascript";
        s.async = true;
        s.src = "//munchkin.marketo.net/munchkin.js";
        s.onreadystatechange = function () {
          if (this.readyState == "complete" || this.readyState == "loaded") {
            initMunchkin();
          }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName("head")[0].appendChild(s);
      })();
    </script>
    <!-- End Marketo -->
    <!-- Expertrec -->
    <script>
      var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
      var ci_search = document.createElement("script");
      ci_search.type = "text/javascript";
      ci_search.async = true;
      ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(ci_search, s);
    </script>
    <!-- End Expertrec -->

    <!-- Font Awesome -->
    <script
      src="https://kit.fontawesome.com/b1870adf6a.js"
      crossorigin="anonymous"
    ></script>
    <!-- End Font Awesome -->
  </head>
  
  <body>
     <header class="header">
  <div class="header-logo">
    <a class="header-logo__img" href="https://scylladb.com/">
      <img
        src="../_static/img/logo-scylla-docs.svg"
        alt="Scylla Documentation Logo"
      />
    </a>
    <span class="header-logo__bar"></span>
    <a class="header-logo__text" href="https://docs.scylladb.com/">
      Documentation
    </a>
  </div>
  <div class="header-navigation">
    <ul
      class="dropdown menu scylla-dropdown scylla-dropdown--header"
      data-dropdown-menu
    >
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Server <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://docs.scylladb.com/"
              ><i class="scylla-icon scylla-icon--about-us"></i>Scylla Open
              Source</a
            >
          </li>
          <li>
            <a href="https://docs.scylladb.com/"
              ><i class="scylla-icon scylla-icon--enterprise"></i>Scylla
              Enterprise</a
            >
          </li>
          <li>
            <a
              href="https://scylla.docs.scylladb.com/master/alternator/alternator.html"
            >
              <i class="scylla-icon scylla-icon--overview"></i>Scylla
              Alternator</a
            >
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Cloud <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://cloud.scylladb.com/">
              <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a
            >
          </li>
          <li>
            <a href="https://docs.scylladb.com/scylla-cloud/">
              <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
              Docs</a
            >
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Tools <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a href="https://manager.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a
            >
          </li>
          <li>
            <a href="https://monitoring.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
              Monitoring Stack</a
            >
          </li>
          <li>
            <a href="https://operator.docs.scylladb.com/">
              <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
            </a>
          </li>
        </ul>
      </li>
      <li class="scylla-dropdown__item">
        <a href="#" class="scylla-dropdown__title"
          >Drivers <i class="chevron scylla-icon scylla-icon--triangle-down"></i
        ></a>
        <ul class="menu scylla-dropdown__content">
          <li>
            <a
              href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/"
            >
              <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
            </a>
          </li>
          <li>
            <a
              href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/"
            >
              <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
            </a>
          </li>
        </ul>
      </li>
    </ul>
    <div class="header-button">
      <a href="https://www.scylladb.com/download/" class="button">Download</a>
    </div>
  </div>
  <div class="header-search-box">
    <div class="search-box">
      <ci-search></ci-search>
    </div>
  </div>
  <div class="side-nav-toggle" data-toggle="side-nav">
  <div class="side-nav-toggle__button">
    <img src="../_static/img/menu.svg" alt="Menu" />
  </div>
</div>
</header>
    <section class="layout ">
      <div class="content large-order-2">
         

        <div class="admonition caution">
          <p class="admonition-title">Caution</p>
          <p>
             You
            are not reading the most current version of the documentation.  If you want up-to-date information, please have a look at

            <a href="../../stable/design-notes/metrics.html">
               4.5  </a
            >.
          </p>
        </div>
        

        <div class="pre-content">
          <div class="pre-content__left"><div class="breadcrumbs">
  <span class="bread__item">
    <a
      href="https://scylla.docs.scylladb.com"
      class="bread__highlight"
    >
      <i class="fas fa-home"></i> Scylla Documentation</a
    ></span
  >
  
  <span class="bread__item"
    ><a href="index.html">Design Notes</a></span
  >
  
  <span class="bread__item bread__item--last">Scylla Metrics</span>
</div></div>
          <div class="pre-content__right"><ul
  class="dropdown menu scylla-dropdown scylla-dropdown--contribute"
  data-dropdown-menu
>
  <li class="scylla-dropdown__item">
    <a class="scylla-dropdown__title" href="#">
      <div class="scylla-dropdown__title--body">
        <i class="icon fa fa-github" aria-hidden="true"></i>
        Contribute
      </div>
      <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
    </a>
    <ul class="menu scylla-dropdown__content">
      <li>
        <a
          href="https://github.com/scylladb/scylla/issues/new?title=Issue in page Scylla Metrics&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylla.docs.scylladb.com/branch-4.4/design-notes/metrics%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
          target="_blank"
          >Report a doc issue
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
      
      <li>
             
        <a
          href="https://github.com/scylladb/scylla/edit/branch-4.4/docs/design-notes/metrics.md"
          target="_blank"
          >Edit this page
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
      
      <li>
        <a href="https://docs.scylladb.com/contribute/" target="_blank"
          >Learn how to contribute
          <i class="icon fa fa-external-link" aria-hidden="true"></i
        ></a>
      </li>
    </ul>
  </li>
</ul></div>
        </div>
         <div class="section" id="scylla-metrics">
<h1>Scylla Metrics<a class="headerlink" href="#scylla-metrics" title="Permalink to this headline">¶</a></h1>
<p>Scylla exposes dozens of different metrics which are valuable for
understanding the performance of a node, and for diagnosing performance
problems when those occur. Among other things, you can see counts of requests,
activity of disks, cpus and network, memory usage of different types,
activity in different individual tables, and many many more metrics.</p>
<p>Scylla’s metrics are implemented using Seastar’s metrics infrastructure.
Scylla’s code updates metrics continuously in memory variables, and then
exposes them through an HTTP request, http://scyllanode:9180/metrics.
The response to this request is a text file listing the metrics and their
current values at the time of the query. This protocol, and the format of
the response was defined by the Prometheus metric collection system and
is described in detail here: https://github.com/prometheus/docs/blob/master/content/docs/instrumenting/exposition_formats.md</p>
<blockquote>
<div><p>Note that the REST API in port 9180 is only devoted to publishing metrics.
Scylla also has a separate and more powerful REST API on port 10000.</p>
</div></blockquote>
<p>This very simple REST API is useful for quick scripting and development work,
but in Scylla production you’d usually want to collect metrics from multiple
Scylla nodes, collect a history of each metric over time, and provide a
graphical UI for viewing graphs of these histories. For this purpose,
we provide the separate scylla-grafana-monitoring project - see
https://github.com/scylladb/scylla-grafana-monitoring on how to install and
use it. The scylla-grafana-monitoring project allows you to continuously
collect metrics from several Scylla nodes into a Prometheus metric-collection
server, and then to visualize these metrics using Grafana and a web browser.
Prometheus and Grafana will be described in separate sections below.</p>
<div class="section" id="metric-labels-shard-instance-and-type">
<h2>Metric labels: shard, instance and type<a class="headerlink" href="#metric-labels-shard-instance-and-type" title="Permalink to this headline">¶</a></h2>
<p>Different Scylla nodes will have different values for each metric (e.g.,
<code class="docutils literal notranslate"><span class="pre">scylla_cql_reads</span></code>, the total number of CQL read requests). Moreover, Scylla
is sharded, meaning that inside each node each core works on its own data
and keeps its own separate metrics. So in the metrics output, each metric
identifier contains, beyond the metric’s name, also an additional label to
qualify which shard this metric comes from. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scylla_cql_reads</span><span class="p">{</span><span class="n">shard</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;derive&quot;</span><span class="p">}</span> <span class="mi">20</span>
</pre></div>
</div>
<p>In this example, this measurement comes from shard 0 (the first shard) of
the node which returned this metric.</p>
<p>When Prometheus collects measurements from multiple nodes, it further adds
an “instance” label to each measurement to remember from which node this
measurement came. The “instance” label has the form <code class="docutils literal notranslate"><span class="pre">ip_address:port</span></code> - see
https://prometheus.io/docs/concepts/jobs_instances/ for more information.
Note again that the instance label is not present in the metrics exposed by
Scylla (<code class="docutils literal notranslate"><span class="pre">http://scyllanode:9180/metrics</span></code>) but added later by Prometheus.</p>
<p>Saving instance and shard ids on each metric is what allows a single
Prometheus server to collect metrics from many Scylla nodes and their shards.
The visualization tool (such as Prometheus itself, or Grafana) can then show
the metrics of different nodes and shards separately, or to calculate and
display various sums - e.g., the sum on all shards of each node, or the total
sum of all shards and all nodes.</p>
<p>The “type” label should be ignored - it appears for historic reasons
(it was used by collectd) and is planned to be removed in the future.</p>
</div>
<div class="section" id="additional-metric-labels">
<h2>Additional metric labels<a class="headerlink" href="#additional-metric-labels" title="Permalink to this headline">¶</a></h2>
<p>In some cases, we have several metrics which measure the same thing but for
different cases. For example, Scylla has about a dozen <em>scheduling groups</em>
(see isolation.md), and we would like to get some statistics - e.g. the
scheduler queue length - separately for each of these scheduling groups.</p>
<p>One option is to have a dozen different metrics with different names, e.g.,
<code class="docutils literal notranslate"><span class="pre">scylla_scheduler_queue_length_main</span></code>, <code class="docutils literal notranslate"><span class="pre">scylla_scheduler_queue_length_statement</span></code>
for the two scheduling groups called “main” and “statement”.</p>
<p>However, there is a second option - which we chose in this case. The second
option is to have just one metric name, and qualify it by a <strong>label</strong> with
a value. In this case, we have one metric name <code class="docutils literal notranslate"><span class="pre">scylla_scheduler_queue_length</span></code>,
and metrics on different scheduling groups differ by the <code class="docutils literal notranslate"><span class="pre">group</span></code> label:
<code class="docutils literal notranslate"><span class="pre">scylla_scheduler_queue_length{group=&quot;main&quot;}</span></code> and
<code class="docutils literal notranslate"><span class="pre">scylla_scheduler_queue_length{group=&quot;statement&quot;}</span></code>.</p>
<p>Each metric reported by Scylla often has multiple labels, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scylla_scheduler_queue_length</span><span class="p">{</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;main&quot;</span><span class="p">,</span><span class="n">shard</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;gauge&quot;</span><span class="p">}</span> <span class="mf">0.000000</span>
</pre></div>
</div>
<p>This metric has the <code class="docutils literal notranslate"><span class="pre">group</span></code> label, saying to which scheduling group this
measurement pertains, and also <code class="docutils literal notranslate"><span class="pre">shard</span></code> and <code class="docutils literal notranslate"><span class="pre">type</span></code> labels which we described
in the previous section.</p>
</div>
<div class="section" id="per-table-metrics">
<h2>Per-table metrics<a class="headerlink" href="#per-table-metrics" title="Permalink to this headline">¶</a></h2>
<p>Most of Scylla’s metrics are global (in each shard). Scylla also supports
per-table metrics, which are maintained separately for each table in the
database.</p>
<p>On a deployment with a large number of tables, this can result in a very
large number of metrics at each time, and overwhelm Scylla’s HTTP
server and/or the Prometheus server collecting these metrics. For this
reason, the per-table metrics are currently <strong>disabled</strong> by default:
The per-table metrics are defined in the <code class="docutils literal notranslate"><span class="pre">table::set_metrics()</span></code> function,
and only added when the <code class="docutils literal notranslate"><span class="pre">enable_keyspace_column_family_metrics</span></code> flag is
enabled (and it is disabled by default).</p>
<p>To enable this flag and the per-table metrics, you can pass the parameters
<code class="docutils literal notranslate"><span class="pre">--enable-keyspace-column-family-metrics</span> <span class="pre">1</span></code> in the Scylla command line, or
set this parameter in Scylla’s configuration file.</p>
<p>We are planning to rethink this approach in the future. In particular,
it’s not great that we currently need to restart Scylla to make these
metrics available. Scylla already maintains these per-table metrics in
per-table memory variables, and we just need a way to optionally expose
them through the HTTP request.</p>
<p>To tell the metrics of the different tables apart, each metric’s identifier
contains the “ks” (<em>keyspace</em>) and “cf” (<em>column family</em> - the old name
for table) as labels. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scylla_column_family_pending_compaction</span><span class="p">{</span><span class="n">cf</span><span class="o">=</span><span class="s2">&quot;IndexInfo&quot;</span><span class="p">,</span><span class="n">ks</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span><span class="n">shard</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;gauge&quot;</span><span class="p">}</span> <span class="mf">0.000000</span>
</pre></div>
</div>
<p>Here we can see the “scylla_column_family_pending_compactions” metric
measured in shard 0 of this node, for the table “IndexInfo” in keyspace
“system”.</p>
</div>
<div class="section" id="types-of-metrics">
<h2>Types of metrics<a class="headerlink" href="#types-of-metrics" title="Permalink to this headline">¶</a></h2>
<p>Scylla metrics fall under three types: “counter”, “gauge” and “histogram”.</p>
<p>Most metrics are of the “counter” type. A counter metric tracks a cumulative
value over objects or events that existed throughout the lifetime of the
node. For example, the “total number of requests processed so far”, or
“the total number of bytes written to disk”.</p>
<p>When visualizing counter metrics, it is often useful to look at the
<em>derivative</em>, or rate of change, of the number, instead of at the cumulative
number itself. Note that Scylla only provides the cumulative number - the
visualization tool used by the user (such as Grafana mentioned earlier) is
responsible for calculating the rate of change - by taking two measurements
of the cumulative value at two different times, and calculating the difference
of cumulative value divided by the time difference. For example, by
subtracting the “total number of requests” values queried one second apart,
we can show the number of requests handled during that second.</p>
<blockquote>
<div><p>In some contexts, we call counter metrics “derive” metrics. We do this
mainly for historic reasons, because our previous focus on the “collectd”
metric collection daemon - which Scylla still supports but is no longer
our recommended choice. Collectd has both “derive” and “counter” metrics
with a subtle difference: Both indicate cumulative values, but “counter”
is a sum of non-negative values, while “derive” is a sum of values which
may be negative. This distinction is not important in Scylla: all our
cumulative metrics are sums of non-negative values, and are monotonically
increasing. So in this document we picked the term “counter” and use it
exclusively.</p>
</div></blockquote>
<p>Contrary to counter metrics which accumulate a measurement throughout the
lifetime of the node, a <strong>gauge</strong> metric measures the state of objects
currently existing in the system. For example, the number of requests being
processed <em>right now</em>, the size of some queue, the amount of memory devoted
now to the row cache, or the amount of disk used now for the data storage.</p>
<p>Gauge metrics are less common than counter metrics. When visualizing them,
one usually wants to look at the metric itself rather than its rate of
change. However, even for gauge metrics it is sometimes useful to visualize
their derivative - for example, a user might want to visualize the rate of
change to the amount of disk storage.</p>
<p>Internally, Scylla calculates many of the gauge metrics just like calculates
counter metrics - as a cumulative value: For example, Scylla maintains a
metric of the number of requests being processed <em>right now</em> by adding 1 to
the metric when starting to process a request, and subtracting 1 when the
request’s processing is complete. This metric is nevertheless labeled “gauge”
because it provides a metric over currently-existing objects in the system
(requests being processed), not a sum of historic information.</p>
<p>TODO: histogram metrics. They are described in the Prometheus document linked
above.</p>
</div>
<div class="section" id="list-of-metrics">
<h2>List of metrics<a class="headerlink" href="#list-of-metrics" title="Permalink to this headline">¶</a></h2>
<p>Looking at the response for http://scyllanode:9180/metrics is the best
way to see the list of metrics currently exposed by Scylla, because it
includes a textual description in a comment above each metric.</p>
<p>TODO: mention source files in which a developer should add new metrics.</p>
</div>
<div class="section" id="prometheus">
<h2>Prometheus<a class="headerlink" href="#prometheus" title="Permalink to this headline">¶</a></h2>
<p>So far, we described Scylla’s internal metric-retrieval recapability,
a REST API for retrieving the current values of all metrics from a single
node. But in production, as well as more advanced debugging sessions, one
usually wants to collect metrics from multiple Scylla nodes, and to collect
and to graph a history of each metric over time. As already mentioned above,
we provide a separate project “scylla-grafana-monitoring” which does exactly
this using the Prometheus time-series database.</p>
<p>Prometheus is installed on a separate monitoring node (which we shall call
below “monitornode”). It connects to several Scylla nodes, and saves their
metrics into a time-series database. Prometheus then allows querying,
analyzing, and and graphing this data, via a Web interface at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">monitornode</span><span class="p">:</span><span class="mi">9090</span><span class="o">/</span>
</pre></div>
</div>
<p>Through this Web interface, a user can search for a metric name (type
a word and see the list of all metrics with this word as part of their
name), and then see the current value of this metric over all shards and
nodes (the “Console” tab), and also see a graph of the value of this
metric over time (the “Graph” tab).</p>
<p>Prometheus allows querying and graphing not only the metric itself, but
also various functions and aggregates of these metrics. For example, if
a user asks to graph some metric <code class="docutils literal notranslate"><span class="pre">xyz</span></code> the result is a graph with multiple
lines, one line for each shard and node. The syntax <code class="docutils literal notranslate"><span class="pre">xyz{instance=&quot;...&quot;}</span></code>
will limit the lines to all shards of just one node (given the node’s IP
address), and the syntax <code class="docutils literal notranslate"><span class="pre">xyz{instance=&quot;...&quot;,shard=&quot;0&quot;}</span></code> will show only
one shard of one node. The syntax <code class="docutils literal notranslate"><span class="pre">xyz{group=~&quot;memtable.*&quot;}</span></code> will show
only metrics where the <code class="docutils literal notranslate"><span class="pre">group</span></code> label matches the given regular expression.</p>
<p>The syntax <code class="docutils literal notranslate"><span class="pre">sum(xyz)</span></code> will plot just one line, with the total of the metric
<code class="docutils literal notranslate"><span class="pre">xyz</span></code> over all shards in all nodes. It’s also possible to plot partial sums -
for example <code class="docutils literal notranslate"><span class="pre">sum(xyz)</span> <span class="pre">by</span> <span class="pre">(group)</span></code> generates a separate sum (and plot line)
for each value of the label <code class="docutils literal notranslate"><span class="pre">group</span></code>.</p>
<p>The expression <code class="docutils literal notranslate"><span class="pre">irate(xyz[1m])</span></code> graphs the rate of change (i.e.,
the derivative) of the metric <code class="docutils literal notranslate"><span class="pre">xyz</span></code>. In this last example, the “1m”
selector is ignored by the <code class="docutils literal notranslate"><span class="pre">irate()</span></code> function, but some duration is required
by the Prometheus syntax.</p>
<p>Prometheus supports many more functions and aggregations, which are described
in its documentation:
https://prometheus.io/docs/prometheus/latest/querying/basics/</p>
</div>
<div class="section" id="grafana">
<h2>Grafana<a class="headerlink" href="#grafana" title="Permalink to this headline">¶</a></h2>
<p>While Prometheus already allows analyzing and graphing metric data, Grafana
is a more advanced user interface which allows displaying many of these graphs
in professional-looking “dashboards” which are more convenient for end-users
who don’t know which metrics Scylla has and what they mean, and want to see
pre-canned dashboards of graphs that are useful for particular purposes.</p>
<p>The Grafana user interface is available in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">monitornode</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span>
</pre></div>
</div>
</div>
</div>
  <div class="content-navigation">
  <div class="navigation navigation--prev">
    <a class="navigation__link" href="lua-type-mapping.html">
      <button class="navigation__button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
      </button>
      <div class="navigation__title">
        <span class="colored">PREVIOUS</span> <br />CQL to Lua type mapping
      </div>
    </a>
  </div>
  <div class="navigation navigation--next">
    <a class="navigation__link" href="migrating-from-users-to-roles.html">
      <div class="navigation__title">
        <span class="colored">NEXT</span> <br />Migrating from users to roles
      </div>
      <button class="navigation__button">
        <i class="scylla-icon scylla-icon--chevron-right"></i>
      </button>
    </a>
  </div>
</div> 
      </div>
      <div
        class="sidebar-left  large-order-1"
      > <div id="side-nav" class="side-nav" data-closable data-toggler=".show">
  <div class="side-nav__search">
    <div class="search-box">
      <ci-search></ci-search>
    </div>
  </div>
  <div class="side-nav__versions">
     <ul
  class="dropdown menu scylla-dropdown scylla-dropdown--versions "
  data-dropdown-menu
>
  <li class="scylla-dropdown__item">
    <a class="scylla-dropdown__title" href="#">
       4.4 
      <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
    </a>
    <ul class="menu scylla-dropdown__content"> 
      <li>
        <a href="../../stable/design-notes/metrics.html"
          >4.5</a
        >
      </li>
       
      <li>
        <a href="metrics.html"
          >4.4</a
        >
      </li>
       
    </ul>
  </li>
</ul> 
  </div>
  <div class="side-nav__content">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Scylla Developer Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alternator/alternator.html">Alternator: DynamoDB API in Scylla</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../alternator/getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alternator/compatibility.html">Scylla Alternator for DynamoDB users</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Design Notes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="IDL.html">IDL definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdc.html">CDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="compaction_controller.html">The Compaction Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="cql-extensions.html">Scylla CQL extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cql3-type-mapping.html">CQL3 Type Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="hinted_handoff_design.html">Hinted Handoff Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="in_memory_representation.html">In-Memory Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="isolation.html">Performance Isolation in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="lua-type-mapping.html">CQL to Lua type mapping</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Scylla Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="migrating-from-users-to-roles.html">Migrating from users to roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="paged-queries.html">Paged queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol-extensions.html">Protocol extensions to the Cassandra Native Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocols.html">Ports and protocols in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis.html">Redis API in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="repair_based_node_ops.html">Repair based node operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="row_cache.html">Row Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="row_level_repair.html">Row level repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="secondary_index.html">Secondary indexes in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="sstable-scylla-format.html">File format of the Scylla.db sstable component</a></li>
<li class="toctree-l2"><a class="reference internal" href="sstables-directory-structure.html">sstables directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_keyspace.html">System keyspace layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_schema_keyspace.html">System schema keyspace layout</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/HACKING.html">Guidelines for developing Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/api_v2.html">Scylla RESTful API V2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/building.html">Building Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/debugging.html">Debugging with GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/docker-hub.html">Docker Hub Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/logging.html">Logging in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/tracing.html">Tracing</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contribute/index.html">Contribute</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribute/CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/backport.html">Backport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/coding-style.html">Scylla Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/maintainer.html">Maintainer’s handbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/review-checklist.html">Review Checklist</a></li>
</ul>
</li>
</ul>

  </div>
</div>
      </div>
      
      <div class="sidebar-right large-order-3">
         <div class="secondary-side-nav">
  <div class="secondary-side-nav__content">
    <p class="topic-title">On this page</p>
    <ul>
<li><a class="reference internal" href="#">Scylla Metrics</a><ul>
<li><a class="reference internal" href="#metric-labels-shard-instance-and-type">Metric labels: shard, instance and type</a></li>
<li><a class="reference internal" href="#additional-metric-labels">Additional metric labels</a></li>
<li><a class="reference internal" href="#per-table-metrics">Per-table metrics</a></li>
<li><a class="reference internal" href="#types-of-metrics">Types of metrics</a></li>
<li><a class="reference internal" href="#list-of-metrics">List of metrics</a></li>
<li><a class="reference internal" href="#prometheus">Prometheus</a></li>
<li><a class="reference internal" href="#grafana">Grafana</a></li>
</ul>
</li>
</ul>

  </div>
</div> 
      </div>
    </section>

    <footer class="footer">
  <div class="footer-group">
    <div class="footer-top">
      <a class="footer-logo" href="https://www.scylladb.com"
        ><img
          src="../_static/img/logo-scylla-horizontal-RGB.svg"
          alt="Logo"
      /></a>
      <div class="footer-links">
        <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
        <a
          class="footer-links__link"
          href="https://www.scylladb.com/company/contact-us/"
          >Contact Us</a
        >
        <a class="footer-links__link" href="https://www.scylladb.com/company/"
          >About Us</a
        >
      </div>
      <div class="footer-actions">
        <a
          class="footer-actions__link"
          href="https://groups.google.com/g/scylladb-users"
          target="_blank"
          ><span
            data-tooltip
            tabindex="1"
            title="User mailing list"
            data-position="bottom"
          >
            <img
              src="../_static/img/icons/icon-mail-list.svg"
              alt="Mail List Icon"
            />
          </span>
        </a>
        <a
          class="footer-actions__link"
          href="http://slack.scylladb.com/"
          target="_blank"
          ><span
            data-tooltip
            tabindex="1"
            title="User Slack channel"
            data-position="bottom"
          >
            <img
              src="../_static/img/icons/icon-slack.svg"
              alt="Slack Icon"
          /></span>
        </a>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="footer-bottom__copyright"> &#169; 2021, ScyllaDB. All rights reserved.
      </div>
      <div class="footer-bottom__last-updated">
        Last updated on 02 December 2021.
      </div>
      <div class="footer-bottom__version">
        Powered by
        <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a> &amp;
        <a href="https://sphinx-theme.scylladb.com/"
          >ScyllaDB Theme 1.0.5</a
        >
      </div>
    </div>
  </div>
</footer>

    <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript>
  </body>
</html>